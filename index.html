<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Choose a card</title>
    <script defer src="https://cloud.umami.is/script.js" data-website-id="dfb68c24-94c7-4b73-a2a9-9dd7914ab7cf"></script>
    <style>
        body {
            background-color: #121212;
            color: white;
            font-family: sans-serif;
            padding: 20px;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
        }

        #controls {
            text-align: center;
            margin-bottom: 20px;
        }

            #controls button {
                margin: 0 10px;
                padding: 8px 14px;
                border: none;
                border-radius: 6px;
                background-color: #333;
                color: white;
                cursor: pointer;
                font-size: 14px;
            }

                #controls button:hover {
                    background-color: #555;
                }

        #searchInput {
            display: block;
            margin: 0 auto 30px auto;
            padding: 10px;
            width: 80%;
            max-width: 400px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #555;
            background: #1e1e1e;
            color: white;
        }

        .category {
            margin-bottom: 20px;
        }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            border-bottom: 1px solid #444;
            padding: 8px 0;
            font-size: 20px;
        }

            .category-header span.toggle {
                font-size: 18px;
                margin-left: 10px;
                color: #aaa;
            }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
            padding-left: 10px;
        }

            .button-group button {
                background-color: #222;
                color: white;
                border: 1px solid #555;
                padding: 10px 16px;
                border-radius: 6px;
                cursor: pointer;
                transition: background 0.2s;
            }

                .button-group button:hover {
                    background-color: #444;
                }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <h1>Choose a character</h1>

    <div id="controls">
        <button id="expandAll">🔼 Unfold all</button>
        <button id="collapseAll">🔽 Fold all</button>
    </div>

    <input type="text" id="searchInput" placeholder="Search a character or serie/game...">
    <div id="cardList"></div>

    <script>
        const cardData = {
            "Genshin Impact": ["Ganyu", "Yelan", "Eula"],
            "Overwatch": ["Dva"],
            "League of Legends": ["Jinx", "Miss_Fortune"],
            "Pokemon": ["Cynthia", "Hex_Maniac"],
            "Hololive": ["Calliope", "Coco", "Okayu", "Mio"],
            "Love Live!": ["Maki", "Setsuna"],
            "High School DxD": ["Rossweiss", "Akeno"],
            "Naruto": ["Tsunade", "Kushina", "Naruko", "Hinata"],
            "Fate": ["Nero", "Scathach"],
            "Final Fantasy": ["Rikku"],
            "Last Origin": ["Sekhmet_of_Death", "Cerestia_of_Life", "Miho"],
            "Azur Lane": ["Elbe"],
            "Umamusume": ["Kiseki"],
            "Other": [
                "Ram", "Yoruichi","Rei",
                "Weiss", "Purah", "2B", "Mitsuri"
            ]
        };

        const cardList = document.getElementById("cardList");
        const searchInput = document.getElementById("searchInput");
        const expandAllBtn = document.getElementById("expandAll");
        const collapseAllBtn = document.getElementById("collapseAll");

        const categoryElements = [];

        function normalize(str) {
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
        }

        for (const category in cardData) {
            const section = document.createElement("div");
            section.classList.add("category");

            const header = document.createElement("div");
            header.classList.add("category-header");

            const title = document.createElement("span");
            const titleText = document.createTextNode(`${category}`);
            const count = document.createElement("span");
            count.classList.add("card-count");
            count.style.marginLeft = "10px";
            count.style.color = "#888";

            title.appendChild(titleText);
            title.appendChild(count);

            const toggle = document.createElement("span");
            toggle.classList.add("toggle");
            toggle.textContent = "➕";

            header.appendChild(title);
            header.appendChild(toggle);
            section.appendChild(header);

            const group = document.createElement("div");
            group.classList.add("button-group", "hidden");

            const buttons = [];

            cardData[category].forEach((cardName) => {
                const btn = document.createElement("button");
                btn.textContent = cardName.replace(/_/g, " ");
                btn.dataset.name = cardName.toLowerCase();
                btn.onclick = () => {
                    window.location.href = `viewer.html?front=${encodeURIComponent(cardName)}.png`;
                };
                group.appendChild(btn);
                buttons.push(btn);
            });

            count.textContent = `(${buttons.length})`;

            section.appendChild(group);
            cardList.appendChild(section);

            header.addEventListener("click", () => {
                const isHidden = group.classList.toggle("hidden");
                toggle.textContent = isHidden ? "➕" : "➖";
            });

            categoryElements.push({ section, group, buttons, toggle, count, titleText, category });
        }

        searchInput.addEventListener("input", () => {
            const search = normalize(searchInput.value.trim());

            categoryElements.forEach(({ section, group, buttons, toggle, count, titleText, category }) => {
                const categoryName = normalize(category);
                let foundInCategory = false;
                let visibleCount = 0;

                const fullMatch = categoryName.includes(search);

                buttons.forEach(btn => {
                    const nameMatch = normalize(btn.dataset.name).includes(search);
                    const show = fullMatch || nameMatch;
                    btn.style.display = show ? "inline-block" : "none";
                    if (show) {
                        foundInCategory = true;
                        visibleCount++;
                    }
                });

                count.textContent = `(${visibleCount})`;

                if (foundInCategory) {
                    section.style.display = "";
                    group.classList.remove("hidden");
                    toggle.textContent = "➖";
                } else {
                    section.style.display = "none";
                }
            });
        });

        expandAllBtn.addEventListener("click", () => {
            categoryElements.forEach(({ group, toggle }) => {
                group.classList.remove("hidden");
                toggle.textContent = "➖";
            });
        });

        collapseAllBtn.addEventListener("click", () => {
            categoryElements.forEach(({ group, toggle }) => {
                group.classList.add("hidden");
                toggle.textContent = "➕";
            });
        });
    </script>

    <footer style="text-align:center; margin-top: 40px; padding: 20px; border-top: 1px solid #333; color: #aaa;">
        <p>
            <a href="index.html" style="color:#aaa; text-decoration:none; margin-right: 15px;">🏠 Index</a>
            |
            <a href="contact.html" style="color:#aaa; text-decoration:none; margin-left: 15px;">📬 Contact me</a>
            |
            <a href="https://twitter.com/SnowBunnBunn" target="_blank" style="color:#aaa; text-decoration:none; margin-left: 15px;">🐦 Twitter</a>
        </p>
    </footer>

</body>
</html>
